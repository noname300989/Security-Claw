---
name: browser-ext-pentest
description: |
  Fully automated browser extension penetration testing skill. Analyzes Chrome/Firefox
  extensions for security vulnerabilities: dangerous permissions, XSS via content scripts,
  background service worker attacks, cross-origin message abuse, storage API leakage,
  CSP bypasses, and privilege escalation. Auto-exploits every finding, captures screenshots
  as evidence, and generates a detailed Markdown report with PoC payloads and remediation.
metadata:
  {
    "openclaw":
      {
        "emoji": "ðŸ§©",
        "requires": { "bins": ["python3"] },
        "install":
          [
            {
              "id": "pip-ext-pentest",
              "kind": "shell",
              "cmd": "pip3 install playwright requests rich pyyaml Pillow",
              "bins": [],
              "label": "Install browser ext pentest dependencies",
            },
            {
              "id": "playwright-install",
              "kind": "shell",
              "cmd": "python3 -m playwright install chromium",
              "bins": [],
              "label": "Install Playwright Chromium browser",
            },
          ],
      },
  }
---

# ðŸ§© Browser Extension Penetration Testing

Automated end-to-end security assessment of Chrome/Firefox browser extensions.

> âœ… **No API key required.** Fully self-contained.

---

## What It Tests

| Category                 | Vulnerabilities                                                                   |
| ------------------------ | --------------------------------------------------------------------------------- |
| **Manifest**             | Dangerous permissions (`<all_urls>`, `webRequest`, `nativeMessaging`, `debugger`) |
| **Content Scripts**      | XSS injection, `innerHTML` sinks, `eval()` usage, `document.write`                |
| **Background Pages**     | Service worker secrets, CORS misconfig, message handler injection                 |
| **Messaging**            | `chrome.runtime.sendMessage` abuse, `window.postMessage` spoofing                 |
| **Storage**              | Sensitive data in `chrome.storage.local/sync`, localStorage leakage               |
| **CSP**                  | Missing/weak extension CSP, script-src bypass                                     |
| **Network**              | HTTP endpoints, missing HTTPS, cleartext credential transmission                  |
| **Privilege Escalation** | Host permission abuse, tab injection, cookie access                               |

---

## Usage

```bash
# Full automated pentest (crx file or unpacked extension dir)
python3 skills/browser-ext-pentest/scripts/ext_pentest.py scan /path/to/extension/ --output report.md

# Scan from Chrome Web Store ID
python3 skills/browser-ext-pentest/scripts/ext_pentest.py scan-store <extension_id> --output report.md

# Manifest-only quick audit
python3 skills/browser-ext-pentest/scripts/manifest_analyzer.py /path/to/manifest.json
```

---

## Agent Usage Examples

```
Pentest the browser extension at /Downloads/myext/ and exploit every finding with screenshots.
Audit the Chrome extension with ID abcdefghijklmnopqrstuvwx for dangerous permissions and XSS.
Run a full browser extension pentest on the unpacked extension, capture PoC screenshots, and generate the report.
```

---

## Output

- **`report.md`** â€” Detailed findings with PoC payloads, screenshots, OWASP mapping, CVSS, CWE, and step-by-step reproduction
- **`screenshots/`** â€” PNG screenshots of each exploit being triggered
- **`findings.json`** â€” Machine-readable structured findings for CI/CD pipelines
